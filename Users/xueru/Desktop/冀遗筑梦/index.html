<div class="product-img">
    <img src="${product.img}" alt="${product.name}">
</div>
<script>
    const API_BASE = ''; // ç¡®ä¿API_BASEå·²æ­£ç¡®é…ç½®

    async function loadProducts() {
        try {
            const res = await fetch(`${API_BASE}/api/products?page=1`);
            const data = await res.json();
            const products = data.items;

            const productGrid = document.querySelector('.product-grid');
            productGrid.innerHTML = ''; // æ¸…ç©ºåŸæœ‰å†…å®¹

            products.forEach(product => {
                const card = `
                    <div class="product-card">
                        <div class="product-img">
                            <img src="${product.img}" alt="${product.name}">
                        </div>
                        <div class="card-body">
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-price">Â¥${product.price}</p>
                            <p class="product-desc">${product.desc}</p>
                            <div class="btn-actions">
                                <button class="btn-buy" onclick="addToCart(${product.id})">åŠ å…¥è´­ç‰©è½¦</button>
                            </div>
                        </div>
                    </div>
                `;
                productGrid.insertAdjacentHTML('beforeend', card);
            });
        } catch (error) {
            console.error('åŠ è½½å•†å“å¤±è´¥:', error);
            alert('åŠ è½½å•†å“å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
        }
    }

    window.onload = function() {
        checkLoginStatus();
        loadProducts(); // åŠ è½½å•†å“æ•°æ®
    };

    function checkLoginStatus() {
        const user = localStorage.getItem('currentUser');
        const authSection = document.getElementById('auth-section');
        if (user) {
            authSection.innerHTML = `
                <span>æ¬¢è¿, ${user}</span>
                <a href="cart.html">ğŸ›’ è´­ç‰©è½¦</a>
                <a href="favorites.html">â¤ï¸ æ”¶è—</a>
                <a href="index.html">é¦–é¡µ</a>
                <a onclick="logout()">é€€å‡º</a>
            `;
        } else {
            authSection.innerHTML = `
                <a href="login.html">ç™»å½•</a>
                <a href="register.html">æ³¨å†Œ</a>
                <a href="index.html">é¦–é¡µ</a>
            `;
        }
    }

    function logout() {
        localStorage.removeItem('currentUser');
        window.location.reload();
    }
</script>
