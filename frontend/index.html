<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>冀遗筑梦 | 数字化非遗盲盒平台</title>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        /* ========================================
           0. 系统变量
           ======================================== */
        :root {
            --c-primary: #2F4842;    /* 青黛 */
            --c-accent: #C1A268;     /* 鎏金 */
            --c-bg: #F2F0EB;         /* 宣纸灰 */
            --c-grid: #E0DED9;       /* 网格线 */
            --c-topbar: #EAE8E3;     /* 顶部导航微色差 */
            --c-danger: #B22222;     /* 朱砂红 */
            --f-serif: 'Noto Serif SC', 'Songti SC', serif;
            --f-mono: 'Courier New', monospace;
            --sidebar-width: 90px;
        }

        /* ========================================
           1. 高级水墨光标系统 (交互升级)
           ======================================== */
        body { cursor: none !important; }
        a, button, .dynasty-mark, .box-card, i, .page-btn { cursor: none !important; }

        #cursor-dot { width: 6px; height: 6px; background: var(--c-primary); position: fixed; pointer-events: none; border-radius: 50%; z-index: 10001; }
        #cursor-wash { 
            width: 25px; height: 25px; border: 1px solid rgba(47, 72, 66, 0.3); 
            position: fixed; pointer-events: none; border-radius: 50%; z-index: 10000; 
            transition: width 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), height 0.3s, background 0.3s;
            mix-blend-mode: multiply; 
        }
        .ink-active { 
            width: 50px !important; height: 50px !important; 
            background: radial-gradient(circle, rgba(193, 162, 104, 0.2) 0%, transparent 80%) !important;
            border-color: var(--c-accent) !important;
        }

        /* ========================================
           2. 基础布局与 [筑梦] 前置背景
           ======================================== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: var(--c-bg); color: var(--c-primary); font-family: var(--f-serif); 
            overflow-x: hidden; 
            background-image: linear-gradient(var(--c-grid) 1px, transparent 1px), linear-gradient(90deg, var(--c-grid) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* [筑梦] 字幕层 - 浮于最前方 */
        .front-parallax-wrapper { 
            position: fixed; width: 100vw; height: 100vh; pointer-events: none; 
            z-index: 2000; /* 极高层级 */
            mix-blend-mode: overlay; /* 融合效果 */
        }
        .front-word { 
            position: absolute; font-size: 28vw; font-weight: 900; line-height: 1; 
            opacity: 0.06; color: var(--c-primary);
            transition: transform 0.2s ease-out;
        }
        #word-zhu { top: 5%; left: -5%; }
        #word-meng { bottom: 5%; right: -5%; }

        /* ========================================
           3. 侧边系列轴 (COLLECTION)
           ======================================== */
        .sidebar { 
            position: fixed; left: 0; top: 0; bottom: 0; width: var(--sidebar-width); 
            background: #fff; border-right: 1.5px solid var(--c-primary); 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: space-between; padding: 40px 0; z-index: 1500;
        }
        .brand-plaque { 
            background: var(--c-primary); color: #fff; padding: 20px 10px; border-radius: 2px; 
            box-shadow: 3px 3px 0 var(--c-accent);
        }
        .brand-vertical { writing-mode: vertical-rl; font-size: 18px; font-weight: 900; letter-spacing: 4px; }

        .series-axis { flex: 1; display: flex; flex-direction: column; justify-content: center; gap: 30px; }
        .series-mark { 
            font-family: var(--f-mono); font-size: 10px; transition: 0.3s; color: #BBB;
            cursor: none; display: flex; flex-direction: column; align-items: center;
        }
        .series-mark span { writing-mode: vertical-rl; margin-top: 5px; font-size: 9px; opacity: 0; transition: 0.3s; }
        .series-mark:hover, .series-mark.active { color: var(--c-primary); transform: scale(1.1); }
        .series-mark:hover span, .series-mark.active span { opacity: 1; }

        .social-icons { display: flex; flex-direction: column; gap: 20px; font-size: 20px; opacity: 0.6; }

        /* ========================================
           4. 顶部功能区 (带色差)
           ======================================== */
        .top-bar { 
            position: sticky; top: 0; padding: 15px 60px; display: flex; 
            justify-content: flex-end; align-items: center; gap: 25px; 
            z-index: 1200; background: rgba(234, 232, 227, 0.9); /* 微色差 */
            backdrop-filter: blur(8px); border-bottom: 1px solid var(--c-grid);
        }
        .top-search { display: flex; align-items: center; border-bottom: 1.5px solid var(--c-primary); padding: 2px 5px; }
        .top-search input { background: none; border: none; outline: none; width: 160px; font-size: 13px; }
        
        .cart-mini { 
            display: flex; align-items: center; gap: 8px; padding: 5px 15px; 
            border: 1px solid var(--c-primary); border-radius: 15px; font-size: 12px;
            transition: 0.3s; font-family: var(--f-mono);
        }
        .cart-mini:hover { background: var(--c-primary); color: #fff; }

        /* ========================================
           5. Hero 区域
           ======================================== */
        .main-content { margin-left: var(--sidebar-width); position: relative; z-index: 10; }
        .hero-section { height: 75vh; padding: 40px 80px; display: flex; align-items: center; overflow: hidden; }
        .hero-img-box { 
            width: 50%; height: 80%; overflow: hidden; border: 1px solid var(--c-primary); 
            box-shadow: 20px 20px 0 rgba(193, 162, 104, 0.1);
        }
        .hero-img { width: 100%; height: 100%; object-fit: cover; transition: 1s ease-out; }
        .hero-text { padding-left: 60px; width: 50%; }
        .hero-text h1 { font-size: 48px; margin-bottom: 20px; }
        .hero-text p { font-size: 16px; line-height: 1.8; color: #666; margin-bottom: 30px; }

        /* ========================================
           6. 商品排版 (紧凑型 2x3)
           ======================================== */
        .shop-layout { display: grid; grid-template-columns: 180px 1fr; padding: 40px 80px; gap: 40px; }
        
        /* 侧边分类 - 精致化 */
        .v-filter { display: flex; flex-direction: column; gap: 10px; }
        .v-filter button { 
            text-align: left; background: none; border: none; padding: 10px 0; 
            font-size: 14px; border-bottom: 1px solid transparent; transition: 0.3s; color: #999;
        }
        .v-filter button.active { color: var(--c-primary); font-weight: bold; border-bottom-color: var(--c-accent); }

        /* 紧凑型网格 */
        .product-grid { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; 
            perspective: 1500px;
        }
        
        .box-card { 
            background: #fff; padding: 12px; border: 1px solid #eee; position: relative;
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            opacity: 0; transform: translateY(40px);
        }
        .box-card.show { opacity: 1; transform: translateY(0); }
        
        .card-img-wrap { height: 200px; overflow: hidden; background: #fdfdfd; position: relative; }
        .card-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .box-card:hover .card-img { transform: scale(1.08); }

        .card-badge { position: absolute; top: 5px; right: 5px; background: var(--c-danger); color: #fff; padding: 2px 8px; font-size: 9px; font-weight: bold; }

        .card-info { padding: 10px 0 0; }
        .price-tag { font-size: 18px; color: var(--c-danger); font-weight: 700; font-family: var(--f-mono); }
        .card-title { font-size: 13px; color: #333; margin: 5px 0; height: 36px; overflow: hidden; }
        
        .btn-reveal { 
            width: 100%; padding: 8px; background: var(--c-primary); color: #fff; border: none; 
            font-size: 11px; transition: 0.3s;
        }
        .btn-reveal:hover { background: var(--c-accent); }

        .paginator { margin-top: 40px; display: flex; justify-content: center; gap: 10px; }
        .page-btn { width: 35px; height: 35px; border: 1px solid var(--c-primary); background: none; font-size: 12px; transition: 0.3s; }
        .page-btn.active { background: var(--c-primary); color: #fff; }

        .progress-bar { position: fixed; top: 0; left: 0; width: 0%; height: 4px; background: var(--c-accent); z-index: 2500; }
    </style>
</head>
<body>
    <!-- [筑梦] 前置层 -->
    <div class="front-parallax-wrapper">
        <div class="front-word" id="word-zhu">筑</div>
        <div class="front-word" id="word-meng">梦</div>
    </div>

    <!-- 交互系统 -->
    <div id="cursor-dot"></div>
    <div id="cursor-wash"></div>
    <div class="progress-bar" id="progressBar"></div>

    <!-- 侧边导航 -->
    <aside class="sidebar">
        <div class="brand-plaque">
            <div class="brand-vertical">冀遗筑梦</div>
        </div>
        <div class="series-axis">
            <div class="series-mark active">01<span>基础款</span></div>
            <div class="series-mark">02<span>进阶款</span></div>
            <div class="series-mark">03<span>珍藏款</span></div>
            <div class="series-mark">04<span>隐藏款</span></div>
        </div>
        <div class="social-icons">
            <i class="fa fa-weixin"></i>
            <i class="fa fa-weibo"></i>
        </div>
    </aside>

    <div class="main-content">
        <!-- 顶部导航 -->
        <header class="top-bar">
            <div class="top-search">
                <input type="text" placeholder="寻找非遗惊喜...">
                <i class="fa fa-search" style="font-size: 12px;"></i>
            </div>
            <div class="cart-mini">
                <i class="fa fa-shopping-basket"></i>
                <span id="cartCount">0</span>
            </div>
            <div style="font-size:12px; font-weight:bold; opacity:0.7;">LOGIN</div>
        </header>

        <!-- Hero区域 -->
        <section class="hero-section" id="heroRegion">
            <div class="hero-img-box">
                <img src="https://picsum.photos/id/1043/1000/1200" alt="正定华塔" class="hero-img" id="heroImg">
            </div>
            <div class="hero-text">
                <div style="color:var(--c-accent); font-weight:bold; letter-spacing:4px; font-size:12px; margin-bottom:10px;">ZHENGDING SERIES</div>
                <h1>广惠寺华塔 · 数字化盲盒</h1>
                <p>探索千年古建的微缩之美。将正定古城的繁复浮雕数字化还原，每一抽都是对历史的重新触碰。</p>
                <button class="btn-reveal" style="width:auto; padding:12px 30px;" onclick="document.getElementById('shopArea').scrollIntoView({behavior:'smooth'})">立即探索</button>
            </div>
        </section>

        <!-- 商城区域 -->
        <div class="shop-layout" id="shopArea">
            <aside class="v-filter">
                <div style="font-family:var(--f-mono); font-size:9px; color:#CCC; letter-spacing:2px; margin-bottom:10px;">COLLECTION</div>
                <button class="active" onclick="filterProducts('all')">全部系列</button>
                <button onclick="filterProducts('工艺')">手作工艺</button>
                <button onclick="filterProducts('雕刻')">金石雕刻</button>
                <button onclick="filterProducts('纸艺')">剪纸光影</button>
            </aside>

            <main>
                <div class="product-grid" id="product-container">
                    <!-- 动态加载 -->
                </div>
                <div class="paginator">
                    <button class="page-btn active" onclick="changePage(1)">1</button>
                    <button class="page-btn" onclick="changePage(2)">2</button>
                </div>
            </main>
        </div>
    </div>

    <script>
        const API_BASE = 'https://jiyi-zhumeng.onrender.com';
        let allProducts = [], currentPage = 1, pageSize = 6;
        let currentCategory = 'all';

        window.onload = function() {
            initCursor();
            initFrontParallax();
            loadProducts();
            window.addEventListener('scroll', () => {
                const scrolled = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                document.getElementById('progressBar').style.width = scrolled + '%';
            });
        };

        // 1. 光标系统
        function initCursor() {
            const dot = document.getElementById('cursor-dot');
            const wash = document.getElementById('cursor-wash');
            window.addEventListener('mousemove', (e) => {
                dot.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`;
                wash.animate({
                    transform: `translate(${e.clientX - 12.5}px, ${e.clientY - 12.5}px)`
                }, { duration: 500, fill: "forwards" });
            });
            document.body.addEventListener('mouseover', (e) => {
                if (e.target.closest('a, button, .box-card, .series-mark')) wash.classList.add('ink-active');
            });
            document.body.addEventListener('mouseout', (e) => {
                if (e.target.closest('a, button, .box-card, .series-mark')) wash.classList.remove('ink-active');
            });
        }

        // 2. [筑梦] 前置大字视差
        function initFrontParallax() {
            const zhu = document.getElementById('word-zhu');
            const meng = document.getElementById('word-meng');
            const img = document.getElementById('heroImg');

            window.addEventListener('mousemove', (e) => {
                const x = (e.clientX - window.innerWidth/2);
                const y = (e.clientY - window.innerHeight/2);
                
                // 筑梦大字大幅位移
                zhu.style.transform = `translate(${x/10}px, ${y/8}px)`;
                meng.style.transform = `translate(${x/12}px, ${y/6}px)`;
                
                // 华塔主图位移
                img.style.transform = `scale(1.05) translate(${x/60}px, ${y/60}px)`;
            });
        }

        // 3. 商品加载
        async function loadProducts() {
            // 模拟 12 个数据 (2页x6个)
            allProducts = Array.from({length: 12}, (_, i) => ({
                id: i + 1,
                name: `正定华塔系列 · 数字化盲盒款式 ${i+1}`,
                price: 199,
                category: i < 4 ? '工艺' : (i < 8 ? '雕刻' : '纸艺')
            }));
            renderProducts();
        }

        function renderProducts() {
            const container = document.getElementById('product-container');
            container.innerHTML = '';
            
            let filtered = currentCategory === 'all' ? allProducts : allProducts.filter(p => p.category === currentCategory);
            const list = filtered.slice((currentPage - 1) * pageSize, currentPage * pageSize);

            list.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'box-card';
                card.innerHTML = `
                    <div class="card-badge">SSR</div>
                    <div class="card-img-wrap">
                        <img src="https://placehold.co/400x500/E0DED9/2F4842?text=NO.${item.id}" class="card-img">
                    </div>
                    <div class="card-info">
                        <span class="price-tag">¥${item.price}</span>
                        <h3 class="card-title">${item.name}</h3>
                        <button class="btn-reveal" onclick="addCart()">揭晓惊喜</button>
                    </div>
                `;
                container.appendChild(card);

                // 物理倾斜
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const rx = (e.clientX - rect.left) / rect.width - 0.5;
                    const ry = (e.clientY - rect.top) / rect.height - 0.5;
                    card.style.transform = `perspective(1000px) rotateY(${rx*15}deg) rotateX(${-ry*15}deg) scale(1.03)`;
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transform = `perspective(1000px) rotateY(0deg) rotateX(0deg) scale(1)`;
                });

                setTimeout(() => card.classList.add('show'), index * 80);
            });
        }

        function filterProducts(cat) {
            currentCategory = cat; currentPage = 1;
            document.querySelectorAll('.v-filter button').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderProducts();
        }

        function changePage(p) {
            currentPage = p;
            document.querySelectorAll('.page-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderProducts();
        }

        function addCart() {
            const count = document.getElementById('cartCount');
            count.textContent = parseInt(count.textContent) + 1;
            alert("已加入惊喜袋！");
        }
    </script>
</body>
</html>
