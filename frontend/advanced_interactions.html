<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>非遗文化 - 高级交互体验</title>
    
    <!-- 引入GSAP库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    
    <style>
        /* 全局样式重置 */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        /* 新中式极简风格 */
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #FDFBF7; /* 米白色背景 */
            color: #333333; /* 墨色文字 */
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* 通用容器样式 */
        .section {
            min-height: 100vh;
            padding: 80px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* 横向卷轴画卷样式 */
        #horizontal-scroll-section {
            position: relative;
            background: #f8f5ee;
            padding: 40px 0;
        }

        .horizontal-container {
            width: 300vw; /* 3倍屏幕宽度 */
            height: 60vh;
            display: flex;
            align-items: center;
        }

        .horizontal-content {
            height: 100%;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .horizontal-item {
            width: 80%;
            height: 80%;
            background: white;
            margin: 0 2.5%;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            border: 1px solid #eaeaea;
        }

        /* 拖拽卡片样式 */
        #draggable-section {
            background: #f0f0f0;
            position: relative;
            overflow: hidden;
        }

        .cards-container {
            position: relative;
            width: 100%;
            height: 70vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card-item {
            position: absolute;
            width: 220px;
            height: 300px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: move;
            border: 1px solid #eee;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card-item:hover {
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            text-align: center;
            margin-top: 15px;
            color: #333;
            font-family: 'Noto Serif SC', serif;
        }

        /* 视差滚动样式 */
        #parallax-section {
            position: relative;
            height: 100vh;
            background: url('https://picsum.photos/1920/1080/?blur=5') center/cover fixed;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
        }

        .parallax-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
        }

        .parallax-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            padding: 20px;
        }

        .step-item {
            opacity: 0;
            transform: translateY(30px);
            margin-bottom: 60px;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .step-title {
            font-size: 28px;
            margin-bottom: 15px;
            font-family: 'Noto Serif SC', serif;
        }

        .step-description {
            font-size: 16px;
            line-height: 1.7;
        }

        /* 导航 */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(253, 251, 247, 0.9);
            padding: 15px 30px;
            display: flex;
            justify-content: center;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        nav a {
            margin: 0 20px;
            text-decoration: none;
            color: #333;
            font-size: 16px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        nav a:hover {
            background: rgba(90, 125, 124, 0.1);
            color: #5a7d7c;
        }

        /* 标题样式 */
        h2 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #333;
            font-family: 'Noto Serif SC', serif;
        }

        p {
            font-size: 18px;
            max-width: 700px;
            text-align: center;
            margin-bottom: 20px;
            color: #555;
        }
    </style>
</head>
<body>
    <!-- 导航 -->
    <nav>
        <a href="#horizontal">横向画卷</a>
        <a href="#draggable">拖拽卡片</a>
        <a href="#parallax">视差滚动</a>
    </nav>

    <!-- 横向卷轴画卷 -->
    <section id="horizontal" class="section">
        <h2>横向卷轴画卷</h2>
        <p>滚动到此区域，页面固定，横向滚动展示长卷内容</p>
    </section>

    <!-- 横向滚动区域 -->
    <section id="horizontal-scroll-section">
        <div class="horizontal-container" id="horizontal-container">
            <div class="horizontal-content">
                <div class="horizontal-item">非遗工艺 1</div>
            </div>
            <div class="horizontal-content">
                <div class="horizontal-item">非遗工艺 2</div>
            </div>
            <div class="horizontal-content">
                <div class="horizontal-item">非遗工艺 3</div>
            </div>
            <div class="horizontal-content">
                <div class="horizontal-item">非遗工艺 4</div>
            </div>
        </div>
    </section>

    <!-- 拖拽卡片区域 -->
    <section id="draggable" class="section">
        <h2>自由拖拽散落卡片</h2>
        <p>点击并拖拽卡片，体验自由摆放的乐趣</p>
    </section>

    <section id="draggable-section">
        <div class="cards-container" id="cards-container">
            <div class="card-item" style="top: 15%; left: 10%; transform: rotate(-5deg);">
                <div class="card-title">陶瓷工艺</div>
            </div>
            <div class="card-item" style="top: 25%; left: 40%; transform: rotate(3deg);">
                <div class="card-title">刺绣艺术</div>
            </div>
            <div class="card-item" style="top: 40%; left: 20%; transform: rotate(-2deg);">
                <div class="card-title">木雕技艺</div>
            </div>
            <div class="card-item" style="top: 35%; left: 60%; transform: rotate(5deg);">
                <div class="card-title">剪纸艺术</div>
            </div>
            <div class="card-item" style="top: 55%; left: 45%; transform: rotate(-3deg);">
                <div class="card-title">书法艺术</div>
            </div>
        </div>
    </section>

    <!-- 视差滚动区域 -->
    <section id="parallax" class="section">
        <h2>滚动叙事视差</h2>
        <p>向下滚动，体验工艺流程的视差效果</p>
    </section>

    <section id="parallax-section">
        <div class="parallax-overlay"></div>
        <div class="parallax-content">
            <div class="step-item">
                <h3 class="step-title">第一步：选料</h3>
                <p class="step-description">精心挑选原材料，确保每一件作品的品质</p>
            </div>
            <div class="step-item">
                <h3 class="step-title">第二步：塑形</h3>
                <p class="step-description">工匠们凭借多年经验，塑造出优美的形态</p>
            </div>
            <div class="step-item">
                <h3 class="step-title">第三步：雕刻</h3>
                <p class="step-description">细致入微的雕刻，展现精湛的技艺</p>
            </div>
            <div class="step-item">
                <h3 class="step-title">第四步：烧制</h3>
                <p class="step-description">恰到好处的火候，成就完美的作品</p>
            </div>
        </div>
    </section>

    <section class="section">
        <h2>非遗文化传承</h2>
        <p>让我们一起守护和传承珍贵的非物质文化遗产</p>
    </section>

    <script>
        // 注册GSAP插件
        gsap.registerPlugin(ScrollTrigger, Draggable);

        // 需求1：横向卷轴画卷
        gsap.to("#horizontal-container", {
            x: () => -(document.querySelector("#horizontal-container").offsetWidth - window.innerWidth),
            ease: "none",
            scrollTrigger: {
                trigger: "#horizontal-scroll-section", // 触发器是整个section
                pin: true, // 固定section
                anticipatePin: 1, // 预先计算pin的空间
                scrub: 1, // 滚动时平滑过渡，值为1表示完全跟随滚动
                start: "top top", // 当section顶部触碰视口顶部时开始
                end: () => "+=" + (document.querySelector("#horizontal-container").offsetWidth - window.innerWidth), // 结束位置取决于内容长度
                invalidateOnRefresh: true // 窗口大小改变时重新计算
            }
        });

        // 需求2：自由拖拽散落卡片
        gsap.utils.toArray(".card-item").forEach(card => {
            // 初始化拖拽功能
            Draggable.create(card, {
                type: "x,y", // 允许x和y方向拖拽
                bounds: "#cards-container", // 限制在容器内拖拽
                edgeResistance: 0.8, // 边缘阻力
                throwProps: true, // 启用惯性投掷
                zIndexBoost: false, // 不自动提升z-index，我们自己控制
                onDragStart: function() {
                    // 拖拽开始时，将卡片置于最顶层
                    this.target.style.zIndex = 100;
                    // 添加放大效果
                    gsap.to(this.target, {
                        scale: 1.05,
                        duration: 0.2
                    });
                },
                onDragEnd: function() {
                    // 拖拽结束时，移除放大效果
                    gsap.to(this.target, {
                        scale: 1,
                        duration: 0.2
                    });
                }
            });
        });

        // 需求3：滚动叙事视差
        // 背景视差效果
        gsap.to("#parallax-section", {
            scale: 1.2, // 轻微放大背景
            scrollTrigger: {
                trigger: "#parallax-section",
                start: "top bottom", // 当section顶部到达视口底部时开始
                end: "bottom top", // 当section底部到达视口顶部时结束
                scrub: true, // 滚动时平滑过渡
            }
        });

        // 步骤项动画
        gsap.utils.toArray(".step-item").forEach((step, i) => {
            gsap.from(step, {
                opacity: 0,
                y: 50,
                duration: 1,
                scrollTrigger: {
                    trigger: step,
                    start: "top 80%", // 当元素顶部到达视口80%位置时开始
                    toggleActions: "play none none reverse" // 滚动到触发点时播放动画，回滚时反向播放
                }
            });
        });

        // 页面加载完成后执行初始化
        document.addEventListener("DOMContentLoaded", function() {
            console.log("非遗文化高级交互体验已加载");
        });
    </script>
</body>
</html>