<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>结缘确权 - 冀遗筑梦</title>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        body { 
            background-color: #F5F3EF; 
            margin: 0; 
            color: #2F4842; 
            font-family: 'Noto Serif SC', serif;
        }

        .main-container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 60px 40px; 
            min-height: 100vh;
        }

        /* 头部设计 */
        .page-header {
            text-align: center;
            border-bottom: 2px solid #2F4842;
            padding-bottom: 40px;
            margin-bottom: 50px;
        }
        .page-header h1 { font-size: 36px; margin: 0 0 10px 0; letter-spacing: 2px; }
        .page-header span { font-size: 12px; color: #C1A268; font-weight: bold; letter-spacing: 5px; }

        /* 订单摘要卡片 */
        .order-card {
            background: #fff;
            border: 1.5px solid #E6E2DC;
            padding: 40px;
            box-shadow: 15px 15px 0 rgba(193, 162, 104, 0.1);
            margin-bottom: 40px;
        }
        .section-title {
            font-size: 14px;
            color: #C1A268;
            font-weight: bold;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-title::after { content: ""; flex: 1; height: 1px; background: #E6E2DC; }

        .item-mini-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #F5F3EF;
        }
        .item-mini-name { font-size: 16px; color: #2F4842; }
        .item-mini-price { font-family: monospace; font-weight: bold; }

        /* 支付方式选择 */
        .method-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .method-item {
            border: 1.5px solid #E6E2DC;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: 0.3s;
        }
        .method-item:hover, .method-item.active {
            border-color: #2F4842;
            background: rgba(47, 72, 66, 0.03);
        }
        .method-item.active {
            box-shadow: inset 0 0 0 1px #2F4842;
        }
        .method-item i { font-size: 20px; }

        /* 确权按钮区域 */
        .footer-action {
            margin-top: 60px;
            text-align: center;
        }
        .total-display {
            margin-bottom: 30px;
        }
        .total-display span { font-size: 12px; opacity: 0.6; display: block; margin-bottom: 10px; }
        .total-display b { font-size: 48px; color: #B22222; font-family: monospace; }

        .btn-secure {
            width: 100%;
            background: #2F4842;
            color: #fff;
            padding: 20px;
            border: none;
            font-size: 16px;
            font-weight: 900;
            letter-spacing: 5px;
            cursor: pointer;
            transition: 0.4s;
            position: relative;
        }
        .btn-secure:hover {
            background: #C1A268;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(193, 162, 104, 0.3);
        }

        .back-link {
            display: inline-block;
            margin-top: 25px;
            color: #999;
            text-decoration: none;
            font-size: 12px;
            transition: 0.3s;
        }
        .back-link:hover { color: #2F4842; }

        /* 成功动画遮罩 */
        .success-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--c-bg);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .success-overlay i { font-size: 80px; color: #C1A268; margin-bottom: 20px; }
    </style>
</head>
<body>

    <div class="main-container">
        <!-- 头部 -->
        <header class="page-header">
            <h1>结缘确权</h1>
            <span>SECURE & LINK COLLECTION</span>
        </header>

        <main>
            <!-- 结缘清单摘要 -->
            <div class="order-card">
                <div class="section-title">结缘清单 / COLLECTION SUMMARY</div>
                <div id="orderItems">
                    <!-- JS动态加载 -->
                </div>
            </div>

            <!-- 确权方式 -->
            <div class="order-card">
                <div class="section-title">选择确权方式 / SELECT METHOD</div>
                <div class="method-grid">
                    <div class="method-item active" onclick="selectMethod(this)">
                        <i class="fa fa-weixin" style="color: #07C160;"></i>
                        <span>微信结缘 / WeChat</span>
                    </div>
                    <div class="method-item" onclick="selectMethod(this)">
                        <i class="fa fa-paypal" style="color: #003087;"></i>
                        <span>数字货币 / Alipay</span>
                    </div>
                </div>
            </div>

            <!-- 最终操作 -->
            <div class="footer-action">
                <div class="total-display">
                    <span>结缘总计 / TOTAL CONTRIBUTION</span>
                    <b id="finalAmount">¥0</b>
                </div>
                <button class="btn-secure" onclick="startSecure()">
                    确权并结缘 / SECURE & LINK
                </button>
                <br>
                <a href="cart.html" class="back-link">返回调整清单 / BACK TO SELECTION</a>
            </div>
        </main>
    </div>

    <!-- 成功提示 -->
    <div class="success-overlay" id="successOverlay">
        <i class="fa fa-check-circle-o"></i>
        <h2 style="letter-spacing: 4px;">结缘成功</h2>
        <p style="color: #999;">主理人，您的遗珍已在空间确权</p>
        <button class="btn-secure" style="width: 200px; margin-top: 30px;" onclick="location.href='index.html'">
            返回空间
        </button>
    </div>

    <script src="common.js"></script>
    <script>
        function loadOrder() {
            const cart = JSON.parse(localStorage.getItem('jiyi_cart') || '[]');
            const container = document.getElementById('orderItems');
            let total = 0;

            if (cart.length === 0) {
                location.href = 'index.html';
                return;
            }

            container.innerHTML = cart.map(item => {
                total += parseFloat(item.price);
                return `
                    <div class="item-mini-row">
                        <span class="item-mini-name">${item.name}</span>
                        <span class="item-mini-price">¥${item.price}</span>
                    </div>
                `;
            }).join('');

            document.getElementById('finalAmount').innerText = `¥${total.toFixed(2)}`;
        }

        function selectMethod(el) {
            document.querySelectorAll('.method-item').forEach(m => m.classList.remove('active'));
            el.classList.add('active');
        }

        function startSecure() {
            const btn = document.querySelector('.btn-secure');
            btn.innerText = "正在确权 / SECURING...";
            btn.style.opacity = "0.7";
            btn.disabled = true;

            // 模拟结缘过程
            setTimeout(() => {
                // 清空选藏清单
                localStorage.removeItem('jiyi_cart');
                // 显示成功遮罩
                document.getElementById('successOverlay').style.display = 'flex';
            }, 2000);
        }

        document.addEventListener('DOMContentLoaded', loadOrder);
    </script>
</body>
</html>
